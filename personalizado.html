<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crea tu Granola</title>
<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: #f4f6f8;
  color: #333;
  margin: 0;
  padding-bottom: 100px;
  font-size: 14px;
}

h1 {
  text-align: center;
  color: #4CAF50;
  margin: 20px 0 10px;
  font-size: 22px;
}

.container {
  max-width: 950px;
  margin: auto;
  background: #fff;
  padding: 18px 20px;
  border-radius: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

h2 {
  color: #4CAF50;
  font-size: 18px;
  margin-bottom: 10px;
}

.bag-options {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 18px;
}

.bag {
  text-align: center;
  cursor: pointer;
  border: 2px solid transparent;
  border-radius: 10px;
  padding: 8px;
  width: 30%;
  min-width: 150px;
  background: #fafafa;
  transition: 0.3s;
  box-shadow: 0 2px 4px rgba(0,0,0,0.04);
}
.bag:hover { border-color: #4CAF50; background: #f4fff4; }
.bag.selected { border-color: #4CAF50; background: #eaffea; }
.bag img { width: 80px; height: auto; }

.section {
  display: none;
  margin-top: 15px;
}

.items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
  gap: 12px;
}

.item {
  background: #f9f9f9;
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.04);
  position: relative;
}

.item img {
  width: 65px;
  height: 65px;
  object-fit: cover;
  border-radius: 8px;
}

.price {
  font-size: 13px;
  color: #777;
  margin: 4px 0;
}

.input-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  margin-top: 4px;
}

.item input {
  width: 50px;
  text-align: center;
  border: 1px solid #ccc;
  border-radius: 5px;
  padding: 3px;
  font-size: 13px;
}

.btn {
  width: 24px;
  height: 24px;
  border: none;
  border-radius: 50%;
  font-size: 15px;
  font-weight: bold;
  background: #e8f5e9;
  color: #4CAF50;
  cursor: pointer;
  transition: .2s;
}
.btn:hover { transform: scale(1.1); background: #c8e6c9; }

.lupa {
  position: absolute;
  top: 6px;
  right: 8px;
  cursor: pointer;
  font-size: 15px;
  color: #4CAF50;
  transition: .2s;
}
.lupa:hover { transform: scale(1.2); color: #388E3C; }

.option-box {
  background: #f9f9f9;
  border-radius: 10px;
  padding: 8px;
  margin-top: 8px;
  font-size: 13px;
}

.toast-note {
  font-size: 12px;
  color: #777;
  margin-top: 3px;
}

.toggle {
  position: relative;
  width: 42px;
  height: 20px;
  display: inline-block;
  margin-top: 6px;
}
.toggle input { display: none; }
.slider {
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: #ccc;
  border-radius: 25px;
  transition: .4s;
}
.slider:before {
  position: absolute;
  content: "";
  height: 15px;
  width: 15px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: .4s;
}
.toggle input:checked + .slider { background-color: #4CAF50; }
.toggle input:checked + .slider:before { transform: translateX(22px); }

#comprar {
  display:block;
  margin:16px auto;
  padding:9px 18px;
  background:#4CAF50;
  color:#fff;
  font-size:15px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
#comprar:disabled {
  background:#ccc;
  cursor:not-allowed;
}

.fixed-progress {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100vw;        /* üëà Usa el ancho real de la ventana */
  margin: 0;           /* üëà Asegura que no haya margen */
  padding: 10px 15px;  /* üëå Peque√±o padding lateral sim√©trico */
  background: white;
  border-top: 2px solid #ddd;
  box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
  box-sizing: border-box; /* üëà Evita que el padding sume al ancho */
}

.progress-wrapper {
  position: relative;
  width: 100%;
  height: 20px;
  background: #ddd;
  border-radius: 10px;
  overflow: hidden;
}

.progress-bar {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 0;
  background: linear-gradient(90deg,#4CAF50,#8BC34A);
  border-radius: 0 10px 10px 0;
  transition: width .4s ease-in-out, background .4s;
}

#statusText {
  text-align: center;
  font-weight: 600;
  font-size: 13px;
  margin-top: 6px;
}

#total {
  text-align: center;
  font-weight: bold;
  font-size: 15px;
  margin-top: 8px;
}

.modal {
  display: none;
  position: fixed;
  z-index: 10;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.4);
}
.modal-content {
  background: white;
  margin: 18% auto;
  padding: 15px;
  border-radius: 10px;
  width: 80%;
  max-width: 360px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.25);
}
.modal h2 { color: #4CAF50; font-size: 18px; }
.modal ul { padding-left: 18px; font-size: 13px; }
.close {
  float: right;
  font-size: 20px;
  cursor: pointer;
}
.close:hover { color: red; }

.full-label {
  color: #2e7d32;
  text-decoration: none;
  font-weight: bold;
}
</style>
</head>
<body>

<h1>Arma tu propia granola</h1>

<div class="container">
  <h2>Escoge el tama√±o de la bolsa</h2>

  <div class="bag-options">
    <div class="bag" data-size="Peque√±a" data-capacity="500">
      <img src="https://cdn-icons-png.flaticon.com/512/3145/3145765.png">
      <p>Bolsa Peque√±a (500 g)</p>
    </div>
    <div class="bag" data-size="Mediana" data-capacity="1000">
      <img src="https://cdn-icons-png.flaticon.com/512/3145/3145771.png">
      <p>Bolsa Mediana (1000 g)</p>
    </div>
    <div class="bag" data-size="Grande" data-capacity="2000">
      <img src="https://cdn-icons-png.flaticon.com/512/3145/3145782.png">
      <p>Bolsa Grande (2000 g)</p>
    </div>
  </div>

  <div class="section" id="frutosSecos">
    <h2>Frutos Secos</h2>
    <div class="items-grid" id="frutosSecosItems"></div>
  </div>

  <div class="section" id="cereales">
    <h2>Cereales Integrales</h2>
    <div class="items-grid" id="cerealesItems"></div>
  </div>

  <div class="section" id="semillas">
    <h2>Semillas</h2>
    <div class="items-grid" id="semillasItems"></div>
  </div>

  <div class="option-box" id="cantidadBolsasBox" style="display:none;">
    <h3>Cantidad de bolsas</h3>
    <div class="input-container" style="justify-content:center;">
      <button class="btn" id="menosBolsas">‚àí</button>
      <input type="number" id="numBolsas" min="1" value="1">
      <button class="btn" id="masBolsas">+</button>
    </div>
  </div>

  <button id="comprar" disabled>üõí Realizar compra</button>
</div>

<div class="fixed-progress">
  <div class="progress-wrapper"><div class="progress-bar" id="progressBar"></div></div>
  <div id="statusText">Selecciona una bolsa para comenzar</div>
  <div id="total">Total: $0 COP</div>
</div>

<!-- Modal Beneficios -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2 id="benefTitle"></h2>
    <ul id="benefList"></ul>
  </div>
</div>

<script>
// === DATOS ===
const beneficios = {
  "Almendras": ["Salud cardiovascular", "Control del az√∫car", "Fortalece los huesos"],
  "Nueces": ["Ricas en omega-3", "Mejoran la memoria", "Reducen el colesterol"],
  "Avellanas": ["Fuente de vitamina E", "Mejoran la digesti√≥n"],
  "Man√≠": ["Energ√≠a natural", "Fuente de prote√≠na vegetal"],
  "Avena integral": ["Regula colesterol", "Favorece la digesti√≥n"],
  "Trigo": ["Aporta fibra", "Energ√≠a prolongada"],
  "Cebada": ["Reduce az√∫car en sangre"],
  "Centeno": ["Favorece la circulaci√≥n"],
  "Ch√≠a": ["Rica en omega-3", "Buena para el coraz√≥n"],
  "Linaza": ["Mejora el tr√°nsito intestinal"],
  "Girasol": ["Fortalece piel y cabello"],
  "Calabaza": ["Rica en zinc y magnesio"]
};

const productos = {
  frutosSecos: [
    ["Almendras", 250, ""],
    ["Nueces", 300, ""],
    ["Avellanas", 280, ""],
    ["Man√≠", 200, ""]
  ],
  cereales: [
    ["Avena integral", 100, ""],
    ["Trigo", 80, ""],
    ["Cebada", 120, ""],
    ["Centeno", 110, ""]
  ],
  semillas: [
    ["Ch√≠a", 150, ""],
    ["Linaza", 100, ""],
    ["Girasol", 90, ""],
    ["Calabaza", 130, ""]
  ]
};

// === CREACI√ìN DE ITEMS ===
function crearItems(lista, contenedorId) {
  const cont = document.getElementById(contenedorId);
  lista.forEach(([nombre, precio, img]) => {
    const isAvena = nombre === "Avena integral";
    cont.innerHTML += `
    <div class="item" data-nombre="${nombre}">
      <span class="lupa" title="Consulta los beneficios">üîç</span>
      <img src="${img}" alt="${nombre}">
      <p><strong>${nombre}</strong></p>
      <div class="price">$${precio.toLocaleString()} / 100g</div>
      <div class="input-container">
        <button class="btn" data-action="minus">‚àí</button>
        <input type="number" min="0" step="100" placeholder="g" value="0">
        <button class="btn" data-action="plus">+</button>
      </div>
      ${isAvena ? `
      <div class="option-box">
        <p>Tueste</p>
        <label class="toggle"><input type="checkbox" class="toasted"><span class="slider"></span></label>
        <div class="toast-note">Tostado +10%</div>
      </div>` : ""}
    </div>`;
  });
}

crearItems(productos.frutosSecos, "frutosSecosItems");
crearItems(productos.cereales, "cerealesItems");
crearItems(productos.semillas, "semillasItems");

// === FUNCIONALIDAD ===
const bags = document.querySelectorAll(".bag");
const progressBar = document.getElementById("progressBar");
const statusText = document.getElementById("statusText");
const totalDiv = document.getElementById("total");
const comprarBtn = document.getElementById("comprar");
const cantidadBox = document.getElementById("cantidadBolsasBox");
const numBolsas = document.getElementById("numBolsas");
let capacidad = 0;

bags.forEach(b => {
  b.onclick = () => {
    bags.forEach(x => x.classList.remove("selected"));
    b.classList.add("selected");
    capacidad = parseInt(b.dataset.capacity);
    document.querySelectorAll(".section").forEach(s => s.style.display = "block");
    cantidadBox.style.display = "block";
    statusText.textContent = `Bolsa ${b.dataset.size} seleccionada (${capacidad} g)`;
    updateProgress();
  };
});

document.getElementById("menosBolsas").onclick = () => {
  if (parseInt(numBolsas.value) > 1) numBolsas.value--;
  updateProgress();
};
document.getElementById("masBolsas").onclick = () => {
  numBolsas.value++;
  updateProgress();
};
numBolsas.addEventListener("input", () => {
  if (numBolsas.value === "" || parseInt(numBolsas.value) < 1) numBolsas.value = 1;
  updateProgress();
});

function updateProgress() {
  if (!capacidad) return;
  const inputs = document.querySelectorAll(".item input[type='number']");
  let total = 0, costo = 0;
  inputs.forEach(i => {
    const val = parseInt(i.value) || 0;
    total += val;
    const nombre = i.closest(".item").dataset.nombre;
    let precio = 0;
    for (let cat in productos) {
      const prod = productos[cat].find(p => p[0] === nombre);
      if (prod) precio = prod[1];
    }
    if (nombre === "Avena integral") {
      const toast = i.closest(".item").querySelector(".toasted");
      if (toast && toast.checked) precio *= 1.1;
    }
    costo += (val / 100) * precio;
  });
  let pct = Math.min((total / capacidad) * 100, 120);
  progressBar.style.width = pct + "%";

  if (total > capacidad) {
    progressBar.style.background = "linear-gradient(90deg,#ff5f5f,#d32f2f)";
    statusText.textContent = `üö´ Sobrecargado (${total} g / ${capacidad} g)`;
  } else if (pct < 60) {
    progressBar.style.background = "linear-gradient(90deg,#FFEB3B,#FBC02D)";
    statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
  } else if (pct < 80) {
    progressBar.style.background = "linear-gradient(90deg,#FFA726,#FB8C00)";
    statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
  } else if (pct < 100) {
    progressBar.style.background = "linear-gradient(90deg,#8BC34A,#7CB342)";
    statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
  } else {
    progressBar.style.background = "linear-gradient(90deg,#2E7D32,#4CAF50)";
    if (Math.round(pct) === 100)
      statusText.innerHTML = `${pct.toFixed(1)}% lleno (<span class="full-label">FULL</span>) (${total} g / ${capacidad} g)`;
    else
      statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
  }

  const totalFinal = costo * parseInt(numBolsas.value);
  totalDiv.textContent = `Total: $${totalFinal.toLocaleString()} COP (${numBolsas.value} bolsa${numBolsas.value>1?"s":""})`;

  comprarBtn.disabled = total !== capacidad;
}

document.addEventListener("click", e => {
  if (e.target.classList.contains("btn") && e.target.closest(".item")) {
    const input = e.target.parentElement.querySelector("input");
    let val = parseInt(input.value) || 0;
    if (e.target.dataset.action === "plus") val += 100;
    else if (val >= 100) val -= 100;
    input.value = val;
    updateProgress();
  }
  if (e.target.classList.contains("toasted")) updateProgress();
});

document.querySelectorAll(".lupa").forEach(l => {
  l.onclick = e => {
    const item = e.target.closest(".item").dataset.nombre;
    const modal = document.getElementById("modal");
    document.getElementById("benefTitle").textContent = `Beneficios de ${item}`;
    const ul = document.getElementById("benefList");
    ul.innerHTML = "";
    beneficios[item].forEach(b => ul.innerHTML += `<li>${b}</li>`);
    modal.style.display = "block";
  };
});
document.querySelector(".close").onclick = () => document.getElementById("modal").style.display = "none";
window.onclick = e => { if (e.target === document.getElementById("modal")) document.getElementById("modal").style.display = "none"; };

comprarBtn.onclick = () => {
  alert("‚úÖ ¬°Tu granola ha sido creada con √©xito!");
};
</script>
</body>
</html>

