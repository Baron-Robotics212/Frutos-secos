<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crea tu Granola</title>
<style>
body {
 margin: 0;
  padding: 0;
  box-sizing: border-box;
  overflow-x: hidden;
  font-family: 'Segoe UI', sans-serif;
  background: #f4f6f8;
  color: #333;
  margin: 0;
  padding-bottom: 100px;
}
h1 {
  text-align: center;
  color: #4CAF50;
  margin: 25px 0;
}
.container {
  max-width: 1100px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 20px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}
.bag-options {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 25px;
}
.bag {
  text-align: center;
  cursor: pointer;
  border: 2px solid transparent;
  border-radius: 12px;
  padding: 10px;
  width: 30%;
  min-width: 160px;
  background: #fafafa;
  transition: 0.3s;
}
.bag:hover { border-color: #4CAF50; background: #f4fff4; }
.bag.selected { border-color: #4CAF50; background: #eaffea; }
.bag img { width: 100px; height: auto; }

.section {
  display: none;
  margin-top: 20px;
}
.section h2 {
  text-align: left;
  color: #4CAF50;
  margin-bottom: 10px;
}
.items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 15px;
}
.item {
  background: #f9f9f9;
  border-radius: 12px;
  padding: 12px;
  text-align: center;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  position: relative;
}
.item img {
  width: 70px; height: 70px;
  border-radius: 10px; object-fit: cover;
}
.price { font-size: 14px; color: #777; margin-bottom: 5px; }
.input-container {
  display: flex; justify-content: center; align-items: center; gap: 6px;
}
.item input {
  width: 70px; padding: 6px;
  font-size: 14px; border-radius: 6px;
  border: 1px solid #ccc; text-align: center;
}
.item input::placeholder { color: #aaa; }
.btn {
  width: 26px; height: 26px;
  border: none; border-radius: 50%;
  font-size: 18px; font-weight: bold;
  background: #e8f5e9; color: #4CAF50;
  cursor: pointer; transition: .2s;
}
.btn:hover { transform: scale(1.15); background: #c8e6c9; }

.lupa {
  position: absolute;
  top: 8px; right: 10px;
  cursor: pointer;
  font-size: 18px;
  color: #4CAF50;
  transition: .2s;
}
.lupa:hover { transform: scale(1.2); color: #388E3C; }

.fixed-progress {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100vw; /* üëà asegura que use todo el ancho real de la ventana */
  box-sizing: border-box;
  background: white;
  border-top: 2px solid #ddd;
  box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
  padding: 10px 15px;
  margin: 0; /* üëà elimina cualquier margen */
}
.progress-wrapper {
  position: relative;
  width: 100%; height: 25px;
  background: #ddd; border-radius: 10px;
  overflow: hidden;
}
.progress-bar {
   position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 0;
  background: linear-gradient(90deg,#4CAF50,#8BC34A);
  border-radius: 0 10px 10px 0; /* mantiene redondeado el extremo derecho */
  transition: width .4s ease-in-out, background .4s;
}
#statusText {
  text-align: center;
  font-weight: 600;
  font-size: 15px;
  margin-top: 8px;
}
#total {
  text-align: center;
  font-weight: bold;
  font-size: 18px;
  margin-top: 10px;
}

.option-box {
  background: #f9f9f9;
  padding: 10px;
  border-radius: 12px;
  margin-top: 15px;
  text-align: center;
}
.toast-note {
  font-size: 13px;
  color: #777;
  margin-top: 5px;
}

.toggle {
  position: relative; width: 50px; height: 25px;
  display: inline-block; margin-top: 8px;
}
.toggle input { display: none; }
.slider {
  position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  background-color: #ccc; border-radius: 25px; transition: .4s;
}
.slider:before {
  position: absolute; content: "";
  height: 19px; width: 19px;
  left: 3px; bottom: 3px;
  background-color: white; border-radius: 50%;
  transition: .4s;
}
.toggle input:checked + .slider { background-color: #4CAF50; }
.toggle input:checked + .slider:before { transform: translateX(25px); }

#comprar {
  display:block; margin:20px auto;
  padding:12px 25px;
  background:#4CAF50; color:#fff;
  font-size:18px; border:none;
  border-radius:10px; cursor:pointer;
}
#comprar:disabled { background:#ccc; cursor:not-allowed; }

.modal {
  display: none;
  position: fixed; z-index: 10;
  left: 0; top: 0; width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.4);
}
.modal-content {
  background: white;
  margin: 15% auto;
  padding: 20px;
  border-radius: 12px;
  width: 80%; max-width: 400px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
.modal h2 { color: #4CAF50; }
.modal ul { padding-left: 20px; }
.close {
  float: right;
  font-size: 22px;
  cursor: pointer;
}
.close:hover { color: red; }

.full-label {
  color: #2e7d32;
  text-decoration: none;
  font-weight: bold;
}
</style>
</head>
<body>
<h1>Arma tu propia granola</h1>

<div class="container">
  <h2 style= color:#4CAF50; margin-bottom:20px;">
    Escoge el tama√±o de la bolsa
  </h2>

  <div class="bag-options">
    <div class="bag" data-size="Peque√±a" data-capacity="500">
      <img src="https://cdn-icons-png.flaticon.com/512/3145/3145765.png">
      <p>Bolsa Peque√±a (500 g)</p>
    </div>
    <div class="bag" data-size="Mediana" data-capacity="1000">
      <img src="https://cdn-icons-png.flaticon.com/512/3145/3145771.png">
      <p>Bolsa Mediana (1000 g)</p>
    </div>
    <div class="bag" data-size="Grande" data-capacity="2000">
      <img src="https://cdn-icons-png.flaticon.com/512/3145/3145782.png">
      <p>Bolsa Grande (2000 g)</p>
    </div>
  </div>

  <!-- Secciones -->
  <div class="section" id="frutosSecos">
    <h2>Frutos Secos</h2>
    <div class="items-grid" id="frutosSecosItems"></div>
  </div>

  <div class="section" id="cereales">
    <h2>Cereales Integrales</h2>
    <div class="items-grid" id="cerealesItems"></div>
  </div>

  <div class="section" id="semillas">
    <h2>Semillas</h2>
    <div class="items-grid" id="semillasItems"></div>
  </div>

  <!-- Cantidad de bolsas (movido aqu√≠) -->
  <div class="option-box" id="cantidadBolsasBox" style="display:none;">
    <h3>Cantidad de bolsas</h3>
    <div class="input-container" style="justify-content:center;">
      <button class="btn" id="menosBolsas">‚àí</button>
      <input type="number" id="numBolsas" min="1" value="1">
      <button class="btn" id="masBolsas">+</button>
    </div>
  </div>

  <button id="comprar" disabled>üõí Realizar compra</button>
</div>

<div class="fixed-progress">
  <div class="progress-wrapper"><div class="progress-bar" id="progressBar"></div></div>
  <div id="statusText">Selecciona una bolsa para comenzar</div>
  <div id="total">Total: $0 COP</div>
</div>

<!-- Modal Beneficios -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2 id="benefTitle"></h2>
    <ul id="benefList"></ul>
  </div>
</div>

<script>
const beneficios = {
  "Almendras": ["Salud cardiovascular", "Control del az√∫car", "Fortalece los huesos"],
  "Nueces": ["Ricas en omega-3", "Mejoran la memoria", "Reducen el colesterol"],
  "Avellanas": ["Fuente de vitamina E", "Mejoran la digesti√≥n"],
  "Man√≠": ["Energ√≠a natural", "Fuente de prote√≠na vegetal"],
  "Avena integral": ["Regula colesterol", "Favorece la digesti√≥n"],
  "Trigo": ["Aporta fibra", "Energ√≠a prolongada"],
  "Cebada": ["Reduce az√∫car en sangre"],
  "Centeno": ["Favorece la circulaci√≥n"],
  "Ch√≠a": ["Rica en omega-3", "Buena para el coraz√≥n"],
  "Linaza": ["Mejora el tr√°nsito intestinal"],
  "Girasol": ["Fortalece piel y cabello"],
  "Calabaza": ["Rica en zinc y magnesio"]
};

const productos = {
  frutosSecos: [
    ["Almendras", 250, ""],
    ["Nueces", 300, ""],
    ["Avellanas", 280, ""],
    ["Man√≠", 200, ""]
  ],
  cereales: [
    ["Avena integral", 100, ""],
    ["Trigo", 80, ""],
    ["Cebada", 120, ""],
    ["Centeno", 110, ""]
  ],
  semillas: [
    ["Ch√≠a", 150, ""],
    ["Linaza", 100, ""],
    ["Girasol", 90, ""],
    ["Calabaza", 130, ""]
  ]
};

function crearItems(lista, contenedorId) {
  const cont = document.getElementById(contenedorId);
  lista.forEach(([nombre, precio, img]) => {
    const isAvena = nombre === "Avena integral";
    cont.innerHTML += `
    <div class="item" data-nombre="${nombre}">
      <span class="lupa" title="Consulta los beneficios">üîç</span>
      <img src="${img}" alt="${nombre}">
      <p>${nombre}</p>
      <div class="price">$${precio.toLocaleString()} / 100g</div>
      <div class="input-container">
        <button class="btn" data-action="minus">‚àí</button>
        <input type="number" min="0" step="100" placeholder="g" value="0">
        <button class="btn" data-action="plus">+</button>
      </div>
      ${isAvena ? `
      <div class="option-box">
        <p>Tueste</p>
        <label class="toggle"><input type="checkbox" class="toasted"><span class="slider"></span></label>
        <div class="toast-note">Tostado +10%</div>
      </div>` : ""}
    </div>`;
  });
}

crearItems(productos.frutosSecos, "frutosSecosItems");
crearItems(productos.cereales, "cerealesItems");
crearItems(productos.semillas, "semillasItems");

const bags = document.querySelectorAll(".bag");
const progressBar = document.getElementById("progressBar");
const statusText = document.getElementById("statusText");
const totalDiv = document.getElementById("total");
const comprarBtn = document.getElementById("comprar");
const cantidadBox = document.getElementById("cantidadBolsasBox");
const numBolsas = document.getElementById("numBolsas");
let capacidad = 0;

bags.forEach(b => {
  b.onclick = () => {
    bags.forEach(x => x.classList.remove("selected"));
    b.classList.add("selected");
    capacidad = parseInt(b.dataset.capacity);
    document.querySelectorAll(".section").forEach(s => s.style.display = "block");
    cantidadBox.style.display = "block";
    statusText.textContent = `Bolsa ${b.dataset.size} seleccionada (${capacidad} g)`;
    updateProgress();
  };
});

// Botones de cantidad
document.getElementById("menosBolsas").onclick = () => {
  if (parseInt(numBolsas.value) > 1) numBolsas.value = parseInt(numBolsas.value) - 1;
  updateProgress();
};
document.getElementById("masBolsas").onclick = () => {
  numBolsas.value = parseInt(numBolsas.value) + 1;
  updateProgress();
};
numBolsas.addEventListener("input", () => {
  if (numBolsas.value === "" || parseInt(numBolsas.value) < 1) numBolsas.value = 1;
  updateProgress();
});

function updateProgress() {
  if (!capacidad) return;
  const inputs = document.querySelectorAll(".item input[type='number']");
  let total = 0, costo = 0;
  inputs.forEach(i => {
    const val = parseInt(i.value) || 0;
    total += val;
    const nombre = i.closest(".item").dataset.nombre;
    let precio = 0;
    for (let cat in productos) {
      const prod = productos[cat].find(p => p[0] === nombre);
      if (prod) precio = prod[1];
    }
    if (nombre === "Avena integral") {
      const toast = i.closest(".item").querySelector(".toasted");
      if (toast && toast.checked) precio *= 1.1;
    }
    costo += (val / 100) * precio;
  });
  let pct = Math.min((total / capacidad) * 100, 120);
  progressBar.style.width = pct + "%";

  if (total > capacidad) {
    progressBar.style.background = "linear-gradient(90deg,#ff5f5f,#d32f2f)";
    statusText.textContent = `üö´ Sobrecargado (${total} g / ${capacidad} g)`;
  } else if (pct < 60) {
    progressBar.style.background = "linear-gradient(90deg,#FFEB3B,#FBC02D)";
    statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
  } else if (pct < 80) {
  progressBar.style.background = "linear-gradient(90deg,#FFA726,#FB8C00)";
  statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
} else if (pct < 100) {
  progressBar.style.background = "linear-gradient(90deg,#8BC34A,#7CB342)";
  statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
} else {
  progressBar.style.background = "linear-gradient(90deg,#2E7D32,#4CAF50)";


  if (Math.round(pct) === 100) {
    statusText.innerHTML = `${pct.toFixed(1)}% lleno (<span class="full-label">FULL</span>) (${total} g / ${capacidad} g)`;
  } else {
    statusText.textContent = `${pct.toFixed(1)}% lleno (${total} g / ${capacidad} g)`;
  }
}

  const totalFinal = costo * parseInt(numBolsas.value);
  totalDiv.textContent = `Total: $${totalFinal.toLocaleString()} COP (${numBolsas.value} bolsa${numBolsas.value>1?"s":""})`;

  // Solo habilitado si total == capacidad
  comprarBtn.disabled = total !== capacidad;
}

// Control botones + y ‚àí de cada item
document.addEventListener("click", e => {
  const itemBtn = e.target.closest(".item") ? e.target : null;
  if (itemBtn && e.target.classList.contains("btn")) {
    const input = e.target.parentElement.querySelector("input");
    if (!input) return;
    let val = parseInt(input.value) || 0;
    val += e.target.dataset.action === "plus" ? 100 : -100;
    if (val < 0) val = 0;
    input.value = val;
    updateProgress();
  }
});

// ‚úÖ Actualiza precio al cambiar el tostado
document.addEventListener("change", e => {
  if (e.target.classList.contains("toasted")) {
    updateProgress();
  }
});

// Modal beneficios
const modal = document.getElementById("modal");
const close = document.querySelector(".close");
const benefTitle = document.getElementById("benefTitle");
const benefList = document.getElementById("benefList");
document.addEventListener("click", e => {
  if (e.target.classList.contains("lupa")) {
    const nombre = e.target.closest(".item").dataset.nombre;
    benefTitle.textContent = nombre;
    const list = beneficios[nombre] || ["Fuente natural de nutrientes"];
    benefList.innerHTML = list.map(b => `<li>${b}</li>`).join("");
    modal.style.display = "block";
  }
});
close.onclick = () => modal.style.display = "none";
window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };
</script>
</body>
</html>
